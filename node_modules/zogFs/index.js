'use strict';

var fs   = require ('fs');
var path = require ('path');

exports.cp = function (src, dst)
{
  fs.createReadStream (src).pipe (fs.createWriteStream (dst));
}

exports.mkdir = function (location, root)
{
  var zogPlatform = require ('zogPlatform');

  var dirs = location.split (path.sep);
  var dir  = dirs.shift ();
  var root = (root || '') + dir + path.sep;

  try
  {
    fs.mkdirSync (root);
  }
  catch (err)
  {
    if (!fs.statSync (root).isDirectory ())
      throw new Error (err);
  }

  return !dirs.length || this.mkdir (dirs.join (path.sep), root);
}

exports.lsdir = function (location, regex)
{
  var listIn = fs.readdirSync (location);
  var listOut = [];

  for (var item in listIn)
  {
    if (regex && !regex.test (listIn[item]))
      continue;

    var dir = path.join (location, listIn[item]);
    var st = fs.statSync (dir);
    if (st.isDirectory (dir))
      listOut.push (listIn[item]);
  }

  return listOut;
}

exports.ls = function (location, regex)
{
  var listIn = fs.readdirSync (location);
  var listOut = [];

  for (var item in listIn)
  {
    if (regex && !regex.test (listIn[item]))
      continue;

    listOut.push (listIn[item]);
  }

  return listOut;
}
